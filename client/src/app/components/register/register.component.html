<h1 class="page-header">Register</h1>

<div class="row show-hide-message">
	<div [ngClass]="messageClass">
		{{ message }}
	</div>
</div>


<form [formGroup]="form" novalidate (submit)="onSubmitForm()">
	<div class="form-group">
		<label for="username">Username</label>
		<div [ngClass]="{'has-error':((form.controls.username.errors || !isUsernameValid) && form.controls.username.dirty), 'has-success':!form.controls.username.errors && isUsernameValid }">
			<input type="text" name="username" formControlName="username" placeholder="*Username" autocomplete="off" class="form-control" (blur)="checkUsername()">
			<!--validation messages-->
			<ul class="help-block">
				<li *ngIf="form.controls.username.errors?.required && form.controls.username.dirty">This field is required</li>
				<li *ngIf="(form.controls.username.errors?.minlength || form.controls.username.errors?.maxlength) && form.controls.username.dirty ">Minimum length: 3, Maximum length: 20</li>
				<li *ngIf="form.controls.username.errors?.notValidUserName && form.controls.username.dirty">Username contains sepcial characters</li>
				<li *ngIf="isUsernameValidMessage">{{ isUsernameValidMessage }}</li>
			</ul>
		</div>
	</div>
	<div class="form-group">
		<label for="email">Email</label>
		<div [ngClass]="{'has-error':((form.controls.email.errors || !isEmailValid) && form.controls.email.dirty), 'has-success':!form.controls.email.errors && isEmailValid }">
			<input type="text" formControlName="email" name="email" placeholder="*Email" autocomplete="off" class="form-control" (blur)="checkEmail()">
			<!--validation messages-->
			<ul class="help-block">
				<li *ngIf="form.controls.email.errors?.required && form.controls.email.dirty">This field is required</li>
				<li *ngIf="(form.controls.email.errors?.minlength || form.controls.email.errors?.maxlength) && form.controls.email.dirty ">Minimum length: 5, Maximum length: 50</li>
				<li *ngIf="form.controls.email.errors?.notValidEmail && form.controls.email.dirty">Email must be valid</li>
				<li *ngIf="isEmailValidMessage">{{ isEmailValidMessage }}</li>
			</ul>
		</div>
	</div>
	<div class="form-group">
		<label for="password">Password</label>
		<div [ngClass]="{'has-error':(form.controls.password.errors && form.controls.password.dirty), 'has-success':!form.controls.password.errors }">
			<input type="password" formControlName="password" name="password" placeholder="*Password" autocomplete="off" class="form-control">
			<!--validation messages-->
			<ul class="help-block">
				<li *ngIf="form.controls.password.errors?.required && form.controls.password.dirty">This field is required</li>
				<li *ngIf="(form.controls.password.errors?.minlength || form.controls.password.errors?.maxlength) && form.controls.password.dirty ">Minimum length: 8, Maximum length: 20</li>
			</ul>
		</div>
	</div>
	<div class="form-group">
		<label for="confirm">Confirm Password</label>
		<div [ngClass]="{'has-error':(form.controls.confirm.errors && form.controls.confirm.dirty) || (form.errors?.notMatchingPasswords && form.controls.confirm.dirty), 'has-success':!form.controls.confirm.errors && !form.errors?.notMatchingPasswords }">
			<input type="password" formControlName="confirm" name="confirm" placeholder="*Confirm Password" autocomplete="off" class="form-control">
			<!--validation messages-->
			<ul class="help-block">
				<li *ngIf="form.controls.confirm.errors?.required && form.controls.confirm.dirty">This field is required</li>
				<li *ngIf="form.errors?.notMatchingPasswords && form.controls.confirm.dirty ">Passwords do not match</li>
			</ul>
		</div>
	</div>
	<input [disabled]="!form.valid || processing || !isEmailValid || !isUsernameValid" type="submit" class="btn btn-primary" value="Submit">
</form>